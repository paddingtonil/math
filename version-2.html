<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×ª×¨×’×•×œ ×œ××‘×—×Ÿ ××ª××˜×™×§×” - ×’×¨×¡×” 2</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .math-expression {
            direction: ltr;
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            color: #059669;
            margin: 1rem 0;
            padding: 1rem;
            background-color: #d1fae5;
            border-radius: 0.5rem;
            border: 2px solid #10b981;
        }
        .level-badge {
            animation: pulse 0.5s ease-in-out;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const MathPracticeGame = () => {
          const [currentQuestion, setCurrentQuestion] = useState(null);
          const [previousQuestionIndex, setPreviousQuestionIndex] = useState(null);
          const [userAnswer, setUserAnswer] = useState('');
          const [feedback, setFeedback] = useState(null);
          const [score, setScore] = useState({ correct: 0, total: 0 });
          const [showExplanation, setShowExplanation] = useState(false);
          const [currentLevel, setCurrentLevel] = useState('regular');
          const [streak, setStreak] = useState(0);
          const [showLevelUp, setShowLevelUp] = useState(false);

          const parseQuestion = (question) => {
            const patterns = [
              /(.+?):\s*(.+)$/,
              /(.+?)\s+([\d\/â…“â…”Â¼Â¾â…›â…œâ…â…]+\s*[+\-Ã—Ã·]\s*.+)$/,
            ];
            
            for (let pattern of patterns) {
              const match = question.match(pattern);
              if (match) {
                return {
                  instruction: match[1].trim(),
                  expression: match[2].trim()
                };
              }
            }
            
            return {
              instruction: question,
              expression: null
            };
          };

          const getLevelText = (level) => {
            switch(level) {
              case 'regular': return '×¨××”: ×¨×’×™×œ×” â­';
              case 'advanced': return '×¨××”: ××ª×§×“××ª â­â­';
              case 'challenge': return '×¨××”: ××ª×’×¨ â­â­â­';
              default: return '';
            }
          };

          const getLevelColor = (level) => {
            switch(level) {
              case 'regular': return 'bg-green-500 text-white';
              case 'advanced': return 'bg-orange-500 text-white';
              case 'challenge': return 'bg-pink-500 text-white';
              default: return 'bg-gray-500';
            }
          };

          // ×‘× ×§ ×©××œ×•×ª ×—×“×© - ×’×¨×¡×” 2
          const questionBank = [
            // ×¨××” ×¨×’×™×œ×” - ×¡×˜ ×©××œ×•×ª ×—×“×©
            {
              question: '×§×¨×/×™ ×•×›×ª×•×‘/×™ ××ª ×”×©×‘×¨: ×©×œ×•×©×” ×—××™×©×™×•×ª',
              answer: '3/5',
              alternatives: ['â…—'],
              explanation: '×©×œ×•×©×” ×—××™×©×™×•×ª = 3 ×—×œ×§×™× ××ª×•×š 5 = 3/5 ××• â…—',
              difficulty: 'regular'
            },
            {
              question: '×›××” ×©×™×©×™×•×ª ×™×© ×‘×©×œ× ××—×“?',
              answer: '6',
              explanation: '×©×œ× ××—×“ = 6/6 = 6 ×©×™×©×™×•×ª',
              difficulty: 'regular'
            },
            {
              question: '×”×× ×”×©×‘×¨ 5/5 ×©×•×•×” ×œ×©×œ×? (×›×Ÿ/×œ×)',
              answer: '×›×Ÿ',
              alternatives: ['yes', '×›'],
              explanation: '5/5 = ×©×œ× ××—×“! ×”××•× ×” ×•×”××›× ×” ×©×•×•×™×',
              difficulty: 'regular'
            },
            {
              question: '×›××” ×—××™×©×™×•×ª ×™×© ×‘×©×œ× ××—×“?',
              answer: '5',
              explanation: '×©×œ× ××—×“ = 5/5 = 5 ×—××™×©×™×•×ª',
              difficulty: 'regular'
            },
            {
              question: '×”××¨/×™ ×œ××¡×¤×¨ ××¢×•×¨×‘: 9/4',
              answer: '2Â¼',
              alternatives: ['2 1/4'],
              explanation: '9Ã·4 = 2 ×©×œ××™× ×•× ×©××¨ 1, ×œ×›×Ÿ 9/4 = 2Â¼',
              difficulty: 'regular',
              commonMistake: '×—×œ×§ ××ª ×”××•× ×” ×‘××›× ×”!'
            },
            {
              question: '×”××¨/×™ ×œ×©×‘×¨ ×¤×©×•×˜: 3Â½',
              answer: '7/2',
              explanation: '3 Ã— 2 = 6, ×•×¢×•×“ 1 = 7, ×œ×›×Ÿ 3Â½ = 7/2',
              difficulty: 'regular',
              commonMistake: '×›×¤×•×œ ×”××›× ×” ×‘×©×œ××™× ×•××– ×—×‘×¨ ×”××•× ×”'
            },
            {
              question: '×¦××¦×/×™: 6/12',
              answer: '1/2',
              alternatives: ['Â½'],
              explanation: '6Ã·6 = 1, 12Ã·6 = 2, ×œ×›×Ÿ 6/12 = 1/2',
              difficulty: 'regular'
            },
            {
              question: '××¦×/×™ ×©× × ×•×¡×£ ×œ×©×‘×¨ â…“ (×¢× ××›× ×” 9):',
              answer: '3/9',
              explanation: 'â…“ = 3/9 (×›×¤×œ× ×• ×”××•× ×” ×•×”××›× ×” ×‘-3)',
              difficulty: 'regular'
            },
            {
              question: '×¦××¦×/×™: 8/12',
              answer: '2/3',
              alternatives: ['â…”'],
              explanation: '8Ã·4 = 2, 12Ã·4 = 3, ×œ×›×Ÿ 8/12 = 2/3',
              difficulty: 'regular'
            },
            {
              question: '×¡××Ÿ/×™ < , > ××• =:    Â¾ ___ Â½',
              answer: '>',
              explanation: '×©×œ×•×©×” ×¨×‘×¢×™× ×’×“×•×œ ×™×•×ª×¨ ××—×¦×™! Â¾ > Â½',
              difficulty: 'regular'
            },
            {
              question: '×¡××Ÿ/×™ < , > ××• =:    3/6 ___ Â½',
              answer: '=',
              explanation: '3/6 = Â½ (×× × ×¦××¦× 3/6 × ×§×‘×œ Â½)',
              difficulty: 'regular'
            },
            {
              question: '×¡××Ÿ/×™ < , > ××• =:    Â¼ ___ â…“',
              answer: '<',
              explanation: '×¨×‘×¢ ×§×˜×Ÿ ××©×œ×™×©! Â¼ < â…“',
              difficulty: 'regular'
            },
            {
              question: '×›×ª×•×‘/×™ ×‘××™×œ×™×: 42,356',
              answer: '××¨×‘×¢×™× ×•×©× ×™×™× ××œ×£ ×©×œ×•×© ×××•×ª ×—××™×©×™× ×•×©×©',
              explanation: '40,000 + 2,000 + 300 + 50 + 6',
              difficulty: 'regular'
            },
            {
              question: '×›×ª×•×‘/×™ ×‘×¡×¤×¨×•×ª: ×©×œ×•×©×™× ×•××—×“ ××œ×£ ×•×©×‘×¢ ×××•×ª',
              answer: '31700',
              alternatives: ['31,700'],
              explanation: '30,000 + 1,000 + 700 = 31,700',
              difficulty: 'regular'
            },
            {
              question: '×›×ª×•×‘/×™ ×‘×¡×¤×¨×•×ª: ×¢×©×¨×™× ××œ×£ ×•×©××•× ×” ×××•×ª',
              answer: '20800',
              alternatives: ['20,800'],
              explanation: '20,000 + 800 = 20,800',
              difficulty: 'regular'
            },
            {
              question: '××” ×”××¡×¤×¨ ×”×¢×•×§×‘ ×œ××¡×¤×¨: 18,999',
              answer: '19000',
              alternatives: ['19,000'],
              explanation: '××—×¨×™ 18,999 ××’×™×¢ 19,000',
              difficulty: 'regular',
              commonMistake: '×©×™× ×œ×‘ ×œ××¢×‘×¨ ×‘×™×Ÿ ××œ×¤×™×!'
            },
            {
              question: '××” ×”××¡×¤×¨ ×”×§×•×“× ×œ××¡×¤×¨: 25,000',
              answer: '24999',
              alternatives: ['24,999'],
              explanation: '×œ×¤× ×™ 25,000 ××’×™×¢ 24,999',
              difficulty: 'regular'
            },
            {
              question: '××” ×”××¡×¤×¨ ×”×¢×•×§×‘ ×œ××¡×¤×¨: 29,099',
              answer: '29100',
              alternatives: ['29,100'],
              explanation: '××—×¨×™ 29,099 ××’×™×¢ 29,100',
              difficulty: 'regular'
            },
            {
              question: '×—×©×‘/×™ ×œ×¤×™ ×¡×“×¨ ×¤×¢×•×œ×•×ª: 30 + 6 Ã— 5',
              answer: '60',
              explanation: '×¨××©×™×ª ×›×¤×œ: 6 Ã— 5 = 30, ×•××– ×—×™×‘×•×¨: 30 + 30 = 60',
              difficulty: 'regular',
              commonMistake: '×›×¤×œ ×ª××™×“ ×§×•×“× ×œ×—×™×‘×•×¨!'
            },
            {
              question: '×—×©×‘/×™ ×œ×¤×™ ×¡×“×¨ ×¤×¢×•×œ×•×ª: (40 - 15) Ã· 5',
              answer: '5',
              explanation: '×¨××©×™×ª ×¡×•×’×¨×™×™×: 40 - 15 = 25, ×•××– ×—×™×œ×•×§: 25 Ã· 5 = 5',
              difficulty: 'regular',
              commonMistake: '×¡×•×’×¨×™×™× ×§×•×“× ×›×œ!'
            },
            {
              question: '×—×©×‘/×™: 24 - 4 Ã— 5',
              answer: '4',
              explanation: '×¨××©×™×ª ×›×¤×œ: 4 Ã— 5 = 20, ×•××– ×—×™×¡×•×¨: 24 - 20 = 4',
              difficulty: 'regular'
            },
            {
              question: '×—×‘×¨/×™: 15,678 + 2,314',
              answer: '17992',
              alternatives: ['17,992'],
              explanation: '×—×™×‘×•×¨ ×¢××•×“×•×ª: 8+4=12 (× ×•×©× 1), 7+1+1=9, 6+3=9, 5+2=7, 1+0=1',
              difficulty: 'regular'
            },
            {
              question: '×—×‘×¨/×™: 9,456 + 3,287',
              answer: '12743',
              alternatives: ['12,743'],
              explanation: '×—×™×‘×•×¨ ×¢××•×“×•×ª = 12,743',
              difficulty: 'regular'
            },
            {
              question: '×—×¡×¨/×™: 32,567 - 11,234',
              answer: '21333',
              alternatives: ['21,333'],
              explanation: '×—×™×¡×•×¨ ×¢××•×“×•×ª: ×”×¤×¨×© = 21,333',
              difficulty: 'regular'
            },
            {
              question: '×—×¡×¨/×™: 27,800 - 5,300',
              answer: '22500',
              alternatives: ['22,500'],
              explanation: '×—×™×¡×•×¨ ×¢××•×“×•×ª = 22,500',
              difficulty: 'regular'
            },
            {
              question: '×—×©×‘/×™: 6,000 + 3,500 - 2,200',
              answer: '7300',
              alternatives: ['7,300'],
              explanation: '6,000 + 3,500 = 9,500, ×•××– 9,500 - 2,200 = 7,300',
              difficulty: 'regular'
            },

            // ×¨××” ××ª×§×“××ª - ×ª×¨×’×™×œ×™× ×—×“×©×™×
            {
              question: '×›×ª×•×‘/×™ ×©× ×™ ×©××•×ª ×©×•× ×™× ×œ×©×‘×¨ â…“:',
              answer: '2/6',
              alternatives: ['3/9', '4/12', '5/15'],
              explanation: '×“×•×’×××•×ª: 2/6, 3/9, 4/12... (×›×œ ××—×“ × ×›×•×Ÿ!)',
              difficulty: 'advanced'
            },
            {
              question: '×”××¨/×™ ×œ××¡×¤×¨ ××¢×•×¨×‘: 13/4',
              answer: '3Â¼',
              alternatives: ['3 1/4'],
              explanation: '13Ã·4 = 3 ×©×œ××™× ×•× ×©××¨ 1, ×œ×›×Ÿ 13/4 = 3Â¼',
              difficulty: 'advanced'
            },
            {
              question: '×”××¨/×™ ×œ×©×‘×¨ ×¤×©×•×˜: 4Â¾',
              answer: '19/4',
              explanation: '4 Ã— 4 = 16, ×•×¢×•×“ 3 = 19, ×œ×›×Ÿ 4Â¾ = 19/4',
              difficulty: 'advanced'
            },
            {
              question: '×¦××¦×/×™ ×¢×“ ×”×¡×•×£: 15/25',
              answer: '3/5',
              alternatives: ['â…—'],
              explanation: '15Ã·5 = 3, 25Ã·5 = 5, ×œ×›×Ÿ 15/25 = 3/5',
              difficulty: 'advanced'
            },
            {
              question: '×¦××¦×/×™ ×¢×“ ×”×¡×•×£: 18/24',
              answer: '3/4',
              alternatives: ['Â¾'],
              explanation: '18Ã·6 = 3, 24Ã·6 = 4, ×œ×›×Ÿ 18/24 = 3/4',
              difficulty: 'advanced',
              commonMistake: '×”××—×œ×§ ×”××©×•×ª×£ ×”×’×“×•×œ ×‘×™×•×ª×¨ ×”×•× 6'
            },
            {
              question: '×›××” ×©×™×©×™×•×ª ×™×© ×‘-3 ×©×œ××™×?',
              answer: '18',
              explanation: '3 Ã— 6 = 18 ×©×™×©×™×•×ª (3 = 18/6)',
              difficulty: 'advanced'
            },
            {
              question: '×¦××¦×/×™ ×•×”×©×•×•×”/×™: 4/8 ___ 3/6',
              answer: '=',
              explanation: '4/8 = Â½ ×•-3/6 = Â½, ×œ×›×Ÿ ×©×•×•×™×!',
              difficulty: 'advanced'
            },
            {
              question: '×¤×¨×§/×™ ×œ××¡×¤×¨×™×: 58,743 = ? ×¢×©×¨×•×ª ××œ×¤×™× + ? ××œ×¤×™×',
              answer: '5',
              alternatives: ['50000', '5+8'],
              explanation: '5 ×¢×©×¨×•×ª ××œ×¤×™× = 50,000, ×•-8 ××œ×¤×™× = 8,000',
              difficulty: 'advanced'
            },
            {
              question: '××” ×¢×¨×š ×”×¡×¤×¨×” 4 ×‘××¡×¤×¨: 42,678',
              answer: '40000',
              alternatives: ['40,000', '××¨×‘×¢×™× ××œ×£'],
              explanation: '×”×¡×¤×¨×” 4 ×‘××§×•× ×¢×©×¨×•×ª ×”××œ×¤×™× = 40,000',
              difficulty: 'advanced'
            },
            {
              question: '××™×–×” ××¡×¤×¨ × ××¦× ×‘×“×™×•×§ ×‘×××¦×¢ ×‘×™×Ÿ 15,400 ×œ-15,600?',
              answer: '15500',
              alternatives: ['15,500'],
              explanation: '15,400 + 100 = 15,500 (××• 15,600 - 100)',
              difficulty: 'advanced'
            },
            {
              question: '×—×©×‘/×™ ×œ×¤×™ ×¡×“×¨ ×¤×¢×•×œ×•×ª: 80 - 4 Ã— 9 + 16',
              answer: '60',
              explanation: '4 Ã— 9 = 36, ××– 80 - 36 = 44, ×•××– 44 + 16 = 60',
              difficulty: 'advanced'
            },
            {
              question: '×—×©×‘/×™ ×œ×¤×™ ×¡×“×¨ ×¤×¢×•×œ×•×ª: 90 Ã· (6 + 3) Ã— 3',
              answer: '30',
              explanation: '×¡×•×’×¨×™×™×: 6 + 3 = 9, ××– 90 Ã· 9 = 10, ×•××– 10 Ã— 3 = 30',
              difficulty: 'advanced'
            },
            {
              question: '×—×‘×¨/×™: 27,845 + 18,376',
              answer: '46221',
              alternatives: ['46,221'],
              explanation: '×—×™×‘×•×¨ ×¢××•×“×•×ª = 46,221',
              difficulty: 'advanced'
            },
            {
              question: '×—×¡×¨/×™: 60,000 - 27,456',
              answer: '32544',
              alternatives: ['32,544'],
              explanation: '×—×™×¡×•×¨ ×¢××•×“×•×ª ×¢× ×©××™×œ×•×ª = 32,544',
              difficulty: 'advanced',
              commonMistake: '×©×™× ×œ×‘ ×œ×©××™×œ×•×ª!'
            },
            {
              question: '××¦×/×™ ××ª ×”××¡×¤×¨ ×”×—×¡×¨: 18,700 + ? = 25,000',
              answer: '6300',
              alternatives: ['6,300'],
              explanation: '25,000 - 18,700 = 6,300',
              difficulty: 'advanced'
            },

            // ×¨××” ××ª×’×¨ - ×©××œ×•×ª ×××ª×’×¨×•×ª ×—×“×©×•×ª
            {
              question: '×¦××¦×/×™ ××ª ×”×©×‘×¨ 30/45 ×¢×“ ×”×¡×•×£:',
              answer: '2/3',
              alternatives: ['â…”'],
              explanation: '30Ã·15 = 2, 45Ã·15 = 3, ×œ×›×Ÿ 30/45 = 2/3',
              difficulty: 'challenge',
              commonMistake: '×”××—×œ×§ ×”××©×•×ª×£ ×”×’×“×•×œ ×‘×™×•×ª×¨ ×”×•× 15'
            },
            {
              question: '×”××¨/×™ 6â…œ ×œ×©×‘×¨ ×¤×©×•×˜:',
              answer: '51/8',
              explanation: '6 Ã— 8 = 48, 48 + 3 = 51, ×œ×›×Ÿ 6â…œ = 51/8',
              difficulty: 'challenge'
            },
            {
              question: '×¡××Ÿ/×™ < , > ××• =:    4/7 ___ â…—',
              answer: '<',
              explanation: '4/7 = 20/35 ×•-â…— = 21/35, ×œ×›×Ÿ 4/7 < â…—',
              difficulty: 'challenge',
              commonMistake: '×”×‘× ×œ××›× ×” ××©×•×ª×£ (35)'
            },
            {
              question: '×¡××Ÿ/×™ < , > ××• =:    7/9 ___ â…˜',
              answer: '<',
              explanation: '7/9 = 35/45 ×•-â…˜ = 36/45, ×œ×›×Ÿ 7/9 < â…˜',
              difficulty: 'challenge'
            },
            {
              question: '×›×ª×•×‘/×™ ××ª ×”××¡×¤×¨ ×”×§×˜×Ÿ ×‘×™×•×ª×¨ ×¢× ×”×¡×¤×¨×•×ª: 5, 8, 2, 9, 0',
              answer: '20589',
              alternatives: ['20,589'],
              explanation: '× ×¡×“×¨ ××”×§×˜×Ÿ ×œ×’×“×•×œ (0 ×œ× ×™×›×•×œ ×œ×”×™×•×ª ×¨××©×•×Ÿ): 2, 0, 5, 8, 9',
              difficulty: 'challenge'
            },
            {
              question: '××” ×”×”×¤×¨×© ×‘×™×Ÿ 99,999 ×œ-10,000?',
              answer: '89999',
              alternatives: ['89,999'],
              explanation: '99,999 - 10,000 = 89,999',
              difficulty: 'challenge'
            },
            {
              question: '×—×©×‘/×™ ×œ×¤×™ ×¡×“×¨ ×¤×¢×•×œ×•×ª: 150 Ã· (12 - 7) + 20 Ã— 2',
              answer: '70',
              explanation: '(12-7)=5, 150Ã·5=30, 20Ã—2=40, 30+40=70',
              difficulty: 'challenge'
            },
            {
              question: '×”×©×œ×/×™ ××ª ×”××©×•×•××”: (? - 15) Ã— 4 = 100',
              answer: '40',
              explanation: '100 Ã· 4 = 25, ××– 25 + 15 = 40',
              difficulty: 'challenge'
            },
            {
              question: '×—×‘×¨/×™: 36,789 + 28,567 + 15,234',
              answer: '80590',
              alternatives: ['80,590'],
              explanation: '×—×™×‘×•×¨ ×©×œ 3 ××¡×¤×¨×™× = 80,590',
              difficulty: 'challenge'
            },
            {
              question: '×—×¡×¨/×™: 90,000 - 48,765',
              answer: '41235',
              alternatives: ['41,235'],
              explanation: '×—×™×¡×•×¨ ×¢× ×©××™×œ×•×ª ×¨×‘×•×ª = 41,235',
              difficulty: 'challenge'
            }
          ];

          const generateNewQuestion = () => {
            const levelQuestions = questionBank.filter(q => q.difficulty === currentLevel);
            let randomIndex;
            
            do {
              randomIndex = Math.floor(Math.random() * levelQuestions.length);
            } while (levelQuestions.length > 1 && previousQuestionIndex === randomIndex);
            
            setCurrentQuestion(levelQuestions[randomIndex]);
            setPreviousQuestionIndex(randomIndex);
            setUserAnswer('');
            setFeedback(null);
            setShowExplanation(false);
          };

          useEffect(() => {
            generateNewQuestion();
          }, [currentLevel]);

          const checkLevelUp = (newStreak) => {
            if (newStreak >= 5) {
              if (currentLevel === 'regular') {
                setCurrentLevel('advanced');
                setShowLevelUp(true);
                setStreak(0);
                setTimeout(() => setShowLevelUp(false), 3000);
              } else if (currentLevel === 'advanced') {
                setCurrentLevel('challenge');
                setShowLevelUp(true);
                setStreak(0);
                setTimeout(() => setShowLevelUp(false), 3000);
              } else {
                setStreak(0);
              }
            }
          };

          const checkAnswer = () => {
            if (!userAnswer.trim()) {
              setFeedback({ correct: false, message: '× × ×œ×”×–×™×Ÿ ×ª×©×•×‘×”' });
              return;
            }

            const normalizedUserAnswer = userAnswer.trim().toLowerCase().replace(/\s+/g, '');
            const normalizedCorrectAnswer = currentQuestion.answer.toLowerCase().replace(/\s+/g, '');
            
            const alternatives = currentQuestion.alternatives || [];
            const isCorrect = normalizedUserAnswer === normalizedCorrectAnswer ||
                             alternatives.some(alt => normalizedUserAnswer === alt.toLowerCase().replace(/\s+/g, ''));

            if (isCorrect) {
              setFeedback({ correct: true, message: 'âœ“ × ×›×•×Ÿ! ×›×œ ×”×›×‘×•×“!' });
              setScore(prev => ({ correct: prev.correct + 1, total: prev.total + 1 }));
              const newStreak = streak + 1;
              setStreak(newStreak);
              checkLevelUp(newStreak);
            } else {
              setFeedback({ 
                correct: false, 
                message: `âœ— ×œ× × ×›×•×Ÿ. ×”×ª×©×•×‘×” ×”× ×›×•× ×”: ${currentQuestion.answer}` 
              });
              setScore(prev => ({ ...prev, total: prev.total + 1 }));
              setStreak(0);
              setShowExplanation(true);
            }
          };

          const handleKeyPress = (e) => {
            if (e.key === 'Enter') {
              if (feedback) {
                generateNewQuestion();
              } else {
                checkAnswer();
              }
            }
          };

          const getDifficultyColor = (difficulty) => {
            switch(difficulty) {
              case 'regular': return 'bg-green-100 text-green-800';
              case 'advanced': return 'bg-orange-100 text-orange-800';
              case 'challenge': return 'bg-pink-100 text-pink-800';
              default: return 'bg-gray-100';
            }
          };

          const getDifficultyText = (difficulty) => {
            switch(difficulty) {
              case 'regular': return '×¨×’×™×œ×”';
              case 'advanced': return '××ª×§×“××ª';
              case 'challenge': return '××ª×’×¨';
              default: return '';
            }
          };

          if (!currentQuestion) return <div className="p-8 text-center">×˜×•×¢×Ÿ...</div>;

          const percentage = score.total > 0 ? Math.round((score.correct / score.total) * 100) : 0;
          const parsedQuestion = parseQuestion(currentQuestion.question);

          return (
            <div className="min-h-screen bg-gradient-to-br from-green-50 to-teal-50 p-6" dir="rtl">
              <div className="max-w-3xl mx-auto">
                <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                  <h1 className="text-3xl font-bold text-center text-green-600 mb-2">
                    ğŸ¯ ×ª×¨×’×•×œ ×œ××‘×—×Ÿ - ×’×¨×¡×” 2
                  </h1>
                  <p className="text-center text-gray-600">×›×™×ª×” ×“' | ××‘×—×Ÿ ×ª××¨×™×š 17/11/2025</p>
                  <p className="text-center text-sm text-green-600 font-semibold mt-2">â­ ×ª×¨×’×™×œ×™× ×—×“×©×™× ×œ×’××¨×™!</p>
                </div>

                <div className="bg-white rounded-lg shadow-lg p-4 mb-6">
                  <div className="flex justify-between items-center">
                    <div className={`px-4 py-2 rounded-lg font-bold level-badge ${getLevelColor(currentLevel)}`}>
                      {getLevelText(currentLevel)}
                    </div>
                    <div>
                      <span className="text-lg font-bold text-orange-600">ğŸ”¥ ×¨×¦×£: {streak}/5</span>
                      {streak > 0 && <span className="text-sm text-gray-600 mr-2">(×¢×•×“ {5 - streak}!)</span>}
                    </div>
                  </div>
                </div>

                {showLevelUp && (
                  <div className="bg-gradient-to-r from-yellow-400 to-orange-500 text-white rounded-lg shadow-lg p-6 mb-6 text-center">
                    <h2 className="text-2xl font-bold mb-2">ğŸ‰ ×›×œ ×”×›×‘×•×“!</h2>
                    <p className="text-xl">×¢×œ×™×ª ×œ×¨××” ×”×‘××”! {getLevelText(currentLevel)}</p>
                  </div>
                )}

                <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                  <div className="grid grid-cols-3 gap-4 text-center">
                    <div>
                      <div className="text-3xl font-bold text-green-600" dir="ltr">{score.correct}</div>
                      <div className="text-sm text-gray-600">×ª×©×•×‘×•×ª × ×›×•× ×•×ª</div>
                    </div>
                    <div>
                      <div className="text-3xl font-bold text-blue-600" dir="ltr">{score.total}</div>
                      <div className="text-sm text-gray-600">×¡×”"×› ×©××œ×•×ª</div>
                    </div>
                    <div>
                      <div className="text-3xl font-bold text-purple-600" dir="ltr">{percentage}%</div>
                      <div className="text-sm text-gray-600">××—×•×– ×”×¦×œ×—×”</div>
                    </div>
                  </div>
                </div>

                <div className="bg-white rounded-lg shadow-lg p-8 mb-6">
                  <div className="flex justify-between items-center mb-4">
                    <span className={`px-3 py-1 rounded-full text-sm font-semibold ${getDifficultyColor(currentQuestion.difficulty)}`}>
                      {getDifficultyText(currentQuestion.difficulty)}
                    </span>
                    <span className="text-sm text-gray-500">×©××œ×” #{score.total + 1}</span>
                  </div>

                  <div className="mb-6">
                    <p className="text-xl font-semibold text-gray-700 mb-3">
                      {parsedQuestion.instruction}
                    </p>
                    {parsedQuestion.expression && (
                      <div className="math-expression">
                        {parsedQuestion.expression}
                      </div>
                    )}
                  </div>

                  <div className="mb-4">
                    <input
                      type="text"
                      value={userAnswer}
                      onChange={(e) => setUserAnswer(e.target.value)}
                      onKeyPress={handleKeyPress}
                      placeholder="×”×§×œ×“/×™ ××ª ×”×ª×©×•×‘×” ×›××Ÿ..."
                      disabled={feedback !== null}
                      className="w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500"
                      dir="ltr"
                      style={{textAlign: 'center', fontSize: '1.5rem'}}
                    />
                  </div>

                  {feedback && (
                    <div className={`p-4 rounded-lg mb-4 ${feedback.correct ? 'bg-green-100 border-2 border-green-500' : 'bg-red-100 border-2 border-red-500'}`}>
                      <p className={`font-bold text-lg ${feedback.correct ? 'text-green-800' : 'text-red-800'}`}>
                        {feedback.message}
                      </p>
                    </div>
                  )}

                  {showExplanation && currentQuestion.explanation && (
                    <div className="bg-blue-50 border-2 border-blue-300 rounded-lg p-4 mb-4">
                      <p className="font-bold text-blue-800 mb-2">ğŸ’¡ ×”×¡×‘×¨:</p>
                      <p className="text-blue-900" dir="ltr" style={{textAlign: 'center'}}>{currentQuestion.explanation}</p>
                    </div>
                  )}

                  {showExplanation && currentQuestion.commonMistake && (
                    <div className="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4 mb-4">
                      <p className="font-bold text-yellow-800 mb-2">âš ï¸ × ×§×•×“×ª ×ª×©×•××ª ×œ×‘:</p>
                      <p className="text-yellow-900">{currentQuestion.commonMistake}</p>
                    </div>
                  )}

                  <div className="flex gap-4">
                    {!feedback ? (
                      <button
                        onClick={checkAnswer}
                        className="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition-colors"
                      >
                        ×‘×“×•×§ ×ª×©×•×‘×”
                      </button>
                    ) : (
                      <button
                        onClick={generateNewQuestion}
                        className="flex-1 bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 px-6 rounded-lg transition-colors"
                      >
                        ×©××œ×” ×”×‘××” â†
                      </button>
                    )}
                  </div>
                </div>

                <div className="bg-white rounded-lg shadow-lg p-6">
                  <h3 className="font-bold text-lg mb-3 text-gray-800">ğŸ“ ×˜×™×¤×™× ×œ×ª×¨×’×•×œ:</h3>
                  <ul className="space-y-2 text-gray-700">
                    <li>â€¢ <strong className="text-green-600">×’×¨×¡×” 2</strong> - ×ª×¨×’×™×œ×™× ×©×•× ×™× ×œ×’××¨×™!</li>
                    <li>â€¢ 5 ×ª×©×•×‘×•×ª × ×›×•× ×•×ª ×‘×¨×¦×£ = ×¢×•×œ×™× ×¨××”! ğŸ”¥</li>
                    <li>â€¢ ×× ×˜×¢×™×ª - ×§×¨×/×™ ××ª ×”×”×¡×‘×¨</li>
                    <li>â€¢ × ×™×ª×Ÿ ×œ×œ×—×•×¥ Enter ×œ×©×œ×•×— ×ª×©×•×‘×”</li>
                    <li>â€¢ ××˜×¨×”: ×œ×”×’×™×¢ ×œ-80% ×”×¦×œ×—×” ×•××¢×œ×”!</li>
                  </ul>
                </div>
              </div>
            </div>
          );
        };

        ReactDOM.render(<MathPracticeGame />, document.getElementById('root'));
    </script>
</body>
</html>
